# Java多线程三
## 竞态条件
当某个计算的正确性取决于多个线程的交替执行时序时，那么就会发生静态条件。  
举一个典型的例子，我们面试的时候经常会遇上这道题：两个线程交替打印0-100。
这道题的难点就在竞态条件上。当两个线程没有交替执行时就会出现类似1324这种情况。
## 临界区
当一段代码通过一些手段使得不能被多个线程同时访问，那么这段代码就被称为临界区。即，JVM中不同线程的程序计数器不会指向同一个临界区的内部。  
由于临界区不会被不同线程同时访问所以临界区内部的代码是线程安全的。
## 锁
锁是用来保护临界区不被多个线程同时访问的工具。根据锁的不同性质，有以下几种对锁的分类。  
1. __内置锁__ 同步代码块，即我们平时最常用的使用`synchronized`实现的锁。这种锁机制通过JVM中的对象头来实现。任何对象都可以作为内置锁。  
2. __重入锁__ 又叫递归锁，当一个线程给临界区上锁后，不允许当前线程再次进入这个临界区，那么我们就说这个锁是不可重入的，反之就是可重入的。重入锁不因为递归造成死锁。  
3. __乐观锁，悲观锁__ 乐观锁，即当进入同步代码的时候，默认不会发生冲突，当竞态条件发生改变时会查看竞态条件是否已经被更新，如果被更新过则根据指定好的策略执行。悲观锁
